<html xml:lang="en" lang="en"><!--Generated by PHP_UML on Wed, 24 Feb 2016 02:26:46 +0100--><head><title>PHPExcel_Shared_OLE\PHPExcel_Shared_OLE</title><link rel="stylesheet" type="text/css" media="all" href="../style.css"></head><body><div id="navigation"><div id="banner"><ul class="sections"><li><a href="../overview-summary.html" title="Summary of all packages">Overview</a></li><li><a href="package-summary.html" title="Summary of PHPExcel_Shared_OLE">Package</a></li><li class="active">Class</li><li><a href="../index-all.html">Index</a></li></ul><ul class="navigFrame"><a href="../index.html?PHPExcel_Shared_OLE/class-PHPExcel_Shared_OLE.html" class="navigFrameElem" target="_top">FRAMES</a> <a href="class-PHPExcel_Shared_OLE.html" class="navigFrameElem" target="_top">NO FRAMES</a></ul></div><ul class="siblingSections"><li><a href="class-PHPExcel_Shared_OLE_PPS.html">Prev Class</a></li></ul></div><div id="content"><div class="classSummary"><h3 id="entityPackage">PHPExcel_Shared_OLE</h3><h1 id="entityName">Class&nbsp;PHPExcel_Shared_OLE</h1><hr>public&nbsp;class&nbsp;<strong>PHPExcel_Shared_OLE</strong><br><p>OLE package base class.<div></div></p><hr></div><div id="fieldSummary"><h2>Field Summary</h2><table border="1" class="tableSummary"><tr><td align="right" width="1%" valign="top"><span class="code">const&nbsp;<a href="../datatype-int.html" class="linkType">int</a> </span></td><td valign="top"><span class="code"><a href="#OLE_PPS_TYPE_ROOT" class="linkSummary">OLE_PPS_TYPE_ROOT</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">const&nbsp;<a href="../datatype-int.html" class="linkType">int</a> </span></td><td valign="top"><span class="code"><a href="#OLE_PPS_TYPE_DIR" class="linkSummary">OLE_PPS_TYPE_DIR</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">const&nbsp;<a href="../datatype-int.html" class="linkType">int</a> </span></td><td valign="top"><span class="code"><a href="#OLE_PPS_TYPE_FILE" class="linkSummary">OLE_PPS_TYPE_FILE</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">const&nbsp;<a href="../datatype-int.html" class="linkType">int</a> </span></td><td valign="top"><span class="code"><a href="#OLE_DATA_SIZE_SMALL" class="linkSummary">OLE_DATA_SIZE_SMALL</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">const&nbsp;<a href="../datatype-int.html" class="linkType">int</a> </span></td><td valign="top"><span class="code"><a href="#OLE_LONG_INT_SIZE" class="linkSummary">OLE_LONG_INT_SIZE</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">const&nbsp;<a href="../datatype-int.html" class="linkType">int</a> </span></td><td valign="top"><span class="code"><a href="#OLE_PPS_SIZE" class="linkSummary">OLE_PPS_SIZE</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-resource.html" class="linkType">resource</a> </span></td><td valign="top"><span class="code"><a href="#%24_file_handle" class="linkSummary">$_file_handle</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-array.html" class="linkType">array</a> </span></td><td valign="top"><span class="code"><a href="#%24_list" class="linkSummary">$_list</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code"></span></td><td valign="top"><span class="code"><a href="#%24root" class="linkSummary">$root</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-array.html" class="linkType">array</a> </span></td><td valign="top"><span class="code"><a href="#%24bbat" class="linkSummary">$bbat</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-array.html" class="linkType">array</a> </span></td><td valign="top"><span class="code"><a href="#%24sbat" class="linkSummary">$sbat</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-int.html" class="linkType">int</a> </span></td><td valign="top"><span class="code"><a href="#%24bigBlockSize" class="linkSummary">$bigBlockSize</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-int.html" class="linkType">int</a> </span></td><td valign="top"><span class="code"><a href="#%24smallBlockSize" class="linkSummary">$smallBlockSize</a></span></td></tr></table></div><div id="methodSummary"><h2>Method Summary</h2><table border="1" class="tableSummary"><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-mixed.html" class="linkType">mixed</a> </span></td><td valign="top"><span class="code"><a href="#read(string%20%24file)" class="linkSummary">read</a>(<a href="../datatype-string.html" class="linkType">string</a> $file)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_getBlockOffset(mixed%20%24blockId)" class="linkSummary">_getBlockOffset</a>(<a href="../datatype-mixed.html" class="linkType">mixed</a> $blockId)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-resource.html" class="linkType">resource</a> </span></td><td valign="top"><span class="code"><a href="#getStream(mixed%20%24blockIdOrPps)" class="linkSummary">getStream</a>(<a href="../datatype-mixed.html" class="linkType">mixed</a> $blockIdOrPps)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;static&nbsp;<a href="../datatype-int.html" class="linkType">int</a> </span></td><td valign="top"><span class="code"><a href="#_readInt1(mixed%20%24fh)" class="linkSummary">_readInt1</a>(<a href="../datatype-mixed.html" class="linkType">mixed</a> $fh)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;static&nbsp;<a href="../datatype-int.html" class="linkType">int</a> </span></td><td valign="top"><span class="code"><a href="#_readInt2(mixed%20%24fh)" class="linkSummary">_readInt2</a>(<a href="../datatype-mixed.html" class="linkType">mixed</a> $fh)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;static&nbsp;<a href="../datatype-int.html" class="linkType">int</a> </span></td><td valign="top"><span class="code"><a href="#_readInt4(mixed%20%24fh)" class="linkSummary">_readInt4</a>(<a href="../datatype-mixed.html" class="linkType">mixed</a> $fh)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-mixed.html" class="linkType">mixed</a> </span></td><td valign="top"><span class="code"><a href="#_readPpsWks(mixed%20%24blockId)" class="linkSummary">_readPpsWks</a>(<a href="../datatype-mixed.html" class="linkType">mixed</a> $blockId)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-boolean.html" class="linkType">boolean</a> </span></td><td valign="top"><span class="code"><a href="#_ppsTreeComplete(integer%20%24index)" class="linkSummary">_ppsTreeComplete</a>(<a href="../datatype-integer.html" class="linkType">integer</a> $index)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-bool.html" class="linkType">bool</a> </span></td><td valign="top"><span class="code"><a href="#isFile(integer%20%24index)" class="linkSummary">isFile</a>(<a href="../datatype-integer.html" class="linkType">integer</a> $index)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-bool.html" class="linkType">bool</a> </span></td><td valign="top"><span class="code"><a href="#isRoot(integer%20%24index)" class="linkSummary">isRoot</a>(<a href="../datatype-integer.html" class="linkType">integer</a> $index)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> </span></td><td valign="top"><span class="code"><a href="#ppsTotal()" class="linkSummary">ppsTotal</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-string.html" class="linkType">string</a> </span></td><td valign="top"><span class="code"><a href="#getData(integer%20%24index,%C2%A0integer%20%24position,%C2%A0integer%20%24length)" class="linkSummary">getData</a>(<a href="../datatype-integer.html" class="linkType">integer</a> $index,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $position,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $length)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> </span></td><td valign="top"><span class="code"><a href="#getDataLength(integer%20%24index)" class="linkSummary">getDataLength</a>(<a href="../datatype-integer.html" class="linkType">integer</a> $index)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;static&nbsp;<a href="../datatype-string.html" class="linkType">string</a> </span></td><td valign="top"><span class="code"><a href="#Asc2Ucs(string%20%24ascii)" class="linkSummary">Asc2Ucs</a>(<a href="../datatype-string.html" class="linkType">string</a> $ascii)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;static&nbsp;<a href="../datatype-string.html" class="linkType">string</a> </span></td><td valign="top"><span class="code"><a href="#LocalDate2OLE(integer%20%24date=null)" class="linkSummary">LocalDate2OLE</a>(<a href="../datatype-integer.html" class="linkType">integer</a> $date=null)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;static&nbsp;<a href="../datatype-string.html" class="linkType">string</a> </span></td><td valign="top"><span class="code"><a href="#OLE2LocalDate(integer%20%24string)" class="linkSummary">OLE2LocalDate</a>(<a href="../datatype-integer.html" class="linkType">integer</a> $string)</span></td></tr></table></div><div id="fieldDetail"><h2>Field Detail</h2><div class="detail" id="OLE_PPS_TYPE_ROOT"><h4>OLE_PPS_TYPE_ROOT</h4><div class="detailContent"><span class="code">const&nbsp;<a href="../datatype-int.html" class="linkType">int</a> <b> OLE_PPS_TYPE_ROOT</b> = 5</span><p></p></div></div><hr><div class="detail" id="OLE_PPS_TYPE_DIR"><h4>OLE_PPS_TYPE_DIR</h4><div class="detailContent"><span class="code">const&nbsp;<a href="../datatype-int.html" class="linkType">int</a> <b> OLE_PPS_TYPE_DIR</b> = 1</span><p></p></div></div><hr><div class="detail" id="OLE_PPS_TYPE_FILE"><h4>OLE_PPS_TYPE_FILE</h4><div class="detailContent"><span class="code">const&nbsp;<a href="../datatype-int.html" class="linkType">int</a> <b> OLE_PPS_TYPE_FILE</b> = 2</span><p></p></div></div><hr><div class="detail" id="OLE_DATA_SIZE_SMALL"><h4>OLE_DATA_SIZE_SMALL</h4><div class="detailContent"><span class="code">const&nbsp;<a href="../datatype-int.html" class="linkType">int</a> <b> OLE_DATA_SIZE_SMALL</b> = 0x1000</span><p></p></div></div><hr><div class="detail" id="OLE_LONG_INT_SIZE"><h4>OLE_LONG_INT_SIZE</h4><div class="detailContent"><span class="code">const&nbsp;<a href="../datatype-int.html" class="linkType">int</a> <b> OLE_LONG_INT_SIZE</b> = 4</span><p></p></div></div><hr><div class="detail" id="OLE_PPS_SIZE"><h4>OLE_PPS_SIZE</h4><div class="detailContent"><span class="code">const&nbsp;<a href="../datatype-int.html" class="linkType">int</a> <b> OLE_PPS_SIZE</b> = 0x80</span><p></p></div></div><hr><div class="detail" id="$_file_handle"><h4>$_file_handle</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-resource.html" class="linkType">resource</a> <b> $_file_handle</b></span><p>The file handle for reading an OLE container<div></div></p></div></div><hr><div class="detail" id="$_list"><h4>$_list</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-array.html" class="linkType">array</a> <b> $_list</b> = array()</span><p>Array of PPS's found on the OLE container<div></div></p></div></div><hr><div class="detail" id="$root"><h4>$root</h4><div class="detailContent"><span class="code">public<b> $root</b></span><p>Root directory of OLE container<div></div></p></div></div><hr><div class="detail" id="$bbat"><h4>$bbat</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-array.html" class="linkType">array</a> <b> $bbat</b></span><p>Big Block Allocation Table<div></div></p></div></div><hr><div class="detail" id="$sbat"><h4>$sbat</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-array.html" class="linkType">array</a> <b> $sbat</b></span><p>Short Block Allocation Table<div></div></p></div></div><hr><div class="detail" id="$bigBlockSize"><h4>$bigBlockSize</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-int.html" class="linkType">int</a> <b> $bigBlockSize</b></span><p>Size of big blocks. This is usually 512.<div></div></p></div></div><hr><div class="detail" id="$smallBlockSize"><h4>$smallBlockSize</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-int.html" class="linkType">int</a> <b> $smallBlockSize</b></span><p>Size of small blocks. This is usually 64.<div></div></p></div></div><hr></div><div id="methodDetail"><h2>Method Detail</h2><div class="detail" id="read(string $file)"><h4>read</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-mixed.html" class="linkType">mixed</a> <b> read</b>(<a href="../datatype-string.html" class="linkType">string</a> $file)</span><p><p>Reads an OLE container from the contents of the file given.</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$file</span> - <br></div></div></div><div class="detail" id="_getBlockOffset(mixed $blockId)"><h4>_getBlockOffset</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _getBlockOffset</b>(<a href="../datatype-mixed.html" class="linkType">mixed</a> $blockId)</span><p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$blockId</span> - <br></div></div></div><div class="detail" id="getStream(mixed $blockIdOrPps)"><h4>getStream</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-resource.html" class="linkType">resource</a> <b> getStream</b>(<a href="../datatype-mixed.html" class="linkType">mixed</a> $blockIdOrPps)</span><p><p>Returns a stream for use with fread() etc. External callers should use PHPExcel_Shared_OLE_PPS_File::getStream().</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$blockIdOrPps</span> - <br></div></div></div><div class="detail" id="_readInt1(mixed $fh)"><h4>_readInt1</h4><div class="detailContent"><span class="code">private&nbsp;static&nbsp;<a href="../datatype-int.html" class="linkType">int</a> <b> _readInt1</b>(<a href="../datatype-mixed.html" class="linkType">mixed</a> $fh)</span><p><p>Reads a signed char.</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$fh</span> - <br></div></div></div><div class="detail" id="_readInt2(mixed $fh)"><h4>_readInt2</h4><div class="detailContent"><span class="code">private&nbsp;static&nbsp;<a href="../datatype-int.html" class="linkType">int</a> <b> _readInt2</b>(<a href="../datatype-mixed.html" class="linkType">mixed</a> $fh)</span><p><p>Reads an unsigned short (2 octets).</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$fh</span> - <br></div></div></div><div class="detail" id="_readInt4(mixed $fh)"><h4>_readInt4</h4><div class="detailContent"><span class="code">private&nbsp;static&nbsp;<a href="../datatype-int.html" class="linkType">int</a> <b> _readInt4</b>(<a href="../datatype-mixed.html" class="linkType">mixed</a> $fh)</span><p><p>Reads an unsigned long (4 octets).</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$fh</span> - <br></div></div></div><div class="detail" id="_readPpsWks(mixed $blockId)"><h4>_readPpsWks</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-mixed.html" class="linkType">mixed</a> <b> _readPpsWks</b>(<a href="../datatype-mixed.html" class="linkType">mixed</a> $blockId)</span><p><p>Gets information about all PPS's on the OLE container from the PPS WK's creates an OLE_PPS object for each one.</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$blockId</span> - <br></div></div></div><div class="detail" id="_ppsTreeComplete(integer $index)"><h4>_ppsTreeComplete</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-boolean.html" class="linkType">boolean</a> <b> _ppsTreeComplete</b>(<a href="../datatype-integer.html" class="linkType">integer</a> $index)</span><p><p>It checks whether the PPS tree is complete (all PPS's read) starting with the given PPS (not necessarily root)</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$index</span> - <br></div></div></div><div class="detail" id="isFile(integer $index)"><h4>isFile</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-bool.html" class="linkType">bool</a> <b> isFile</b>(<a href="../datatype-integer.html" class="linkType">integer</a> $index)</span><p><p>Checks whether a PPS is a File PPS or not.<br>If there is no PPS for the index given, it will return false.</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$index</span> - <br></div></div></div><div class="detail" id="isRoot(integer $index)"><h4>isRoot</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-bool.html" class="linkType">bool</a> <b> isRoot</b>(<a href="../datatype-integer.html" class="linkType">integer</a> $index)</span><p><p>Checks whether a PPS is a Root PPS or not.<br>If there is no PPS for the index given, it will return false.</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$index</span> - <br></div></div></div><div class="detail" id="ppsTotal()"><h4>ppsTotal</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> <b> ppsTotal</b>()</span><p><p>Gives the total number of PPS's found in the OLE container.</p></p></div></div><div class="detail" id="getData(integer $index,&nbsp;integer $position,&nbsp;integer $length)"><h4>getData</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-string.html" class="linkType">string</a> <b> getData</b>(<a href="../datatype-integer.html" class="linkType">integer</a> $index,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $position,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $length)</span><p><p>Gets data from a PPS If there is no PPS for the index given, it will return an empty string.</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$index</span> - <br><span class="code">$position</span> - <br><span class="code">$length</span> - <br></div></div></div><div class="detail" id="getDataLength(integer $index)"><h4>getDataLength</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> <b> getDataLength</b>(<a href="../datatype-integer.html" class="linkType">integer</a> $index)</span><p><p>Gets the data length from a PPS If there is no PPS for the index given, it will return 0.</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$index</span> - <br></div></div></div><div class="detail" id="Asc2Ucs(string $ascii)"><h4>Asc2Ucs</h4><div class="detailContent"><span class="code">public&nbsp;static&nbsp;<a href="../datatype-string.html" class="linkType">string</a> <b> Asc2Ucs</b>(<a href="../datatype-string.html" class="linkType">string</a> $ascii)</span><p><p>Utility function to transform ASCII text to Unicode</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$ascii</span> - <br></div></div></div><div class="detail" id="LocalDate2OLE(integer $date=null)"><h4>LocalDate2OLE</h4><div class="detailContent"><span class="code">public&nbsp;static&nbsp;<a href="../datatype-string.html" class="linkType">string</a> <b> LocalDate2OLE</b>(<a href="../datatype-integer.html" class="linkType">integer</a> $date=null)</span><p><p>Utility function Returns a string for the OLE container with the date given</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$date</span> - <br></div></div></div><div class="detail" id="OLE2LocalDate(integer $string)"><h4>OLE2LocalDate</h4><div class="detailContent"><span class="code">public&nbsp;static&nbsp;<a href="../datatype-string.html" class="linkType">string</a> <b> OLE2LocalDate</b>(<a href="../datatype-integer.html" class="linkType">integer</a> $string)</span><p><p>Returns a timestamp from an OLE container's date</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$string</span> - <br></div></div></div></div></div></body></html>
