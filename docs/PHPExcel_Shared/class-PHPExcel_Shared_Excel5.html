<html xml:lang="en" lang="en"><!--Generated by PHP_UML on Wed, 24 Feb 2016 02:26:46 +0100--><head><title>PHPExcel_Shared\PHPExcel_Shared_Excel5</title><link rel="stylesheet" type="text/css" media="all" href="../style.css"></head><body><div id="navigation"><div id="banner"><ul class="sections"><li><a href="../overview-summary.html" title="Summary of all packages">Overview</a></li><li><a href="package-summary.html" title="Summary of PHPExcel_Shared">Package</a></li><li class="active">Class</li><li><a href="../index-all.html">Index</a></li></ul><ul class="navigFrame"><a href="../index.html?PHPExcel_Shared/class-PHPExcel_Shared_Excel5.html" class="navigFrameElem" target="_top">FRAMES</a> <a href="class-PHPExcel_Shared_Excel5.html" class="navigFrameElem" target="_top">NO FRAMES</a></ul></div><ul class="siblingSections"><li><a href="class-PHPExcel_Shared_Drawing.html">Prev Class</a></li><li class="last"><a href="class-PHPExcel_Shared_File.html">Next Class</a></li></ul></div><div id="content"><div class="classSummary"><h3 id="entityPackage">PHPExcel_Shared</h3><h1 id="entityName">Class&nbsp;PHPExcel_Shared_Excel5</h1><hr>public&nbsp;class&nbsp;<strong>PHPExcel_Shared_Excel5</strong><br><p>PHPExcel_Shared_Excel5<div></div></p><hr></div><div id="methodSummary"><h2>Method Summary</h2><table border="1" class="tableSummary"><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;static&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> </span></td><td valign="top"><span class="code"><a href="#sizeCol(%24sheet,%C2%A0string%20%24col='A')" class="linkSummary">sizeCol</a>($sheet,&nbsp;<a href="../datatype-string.html" class="linkType">string</a> $col='A')</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;static&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> </span></td><td valign="top"><span class="code"><a href="#sizeRow(%24sheet,%C2%A0int%20%24row=1)" class="linkSummary">sizeRow</a>($sheet,&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $row=1)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;static&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> </span></td><td valign="top"><span class="code"><a href="#getDistanceX(%24sheet,%C2%A0string%20%24startColumn='A',%C2%A0int%20%24startOffsetX=0,%C2%A0string%20%24endColumn='A',%C2%A0int%20%24endOffsetX=0)" class="linkSummary">getDistanceX</a>($sheet,&nbsp;<a href="../datatype-string.html" class="linkType">string</a> $startColumn='A',&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $startOffsetX=0,&nbsp;<a href="../datatype-string.html" class="linkType">string</a> $endColumn='A',&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $endOffsetX=0)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;static&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> </span></td><td valign="top"><span class="code"><a href="#getDistanceY(%24sheet,%C2%A0int%20%24startRow=1,%C2%A0int%20%24startOffsetY=0,%C2%A0int%20%24endRow=1,%C2%A0int%20%24endOffsetY=0)" class="linkSummary">getDistanceY</a>($sheet,&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $startRow=1,&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $startOffsetY=0,&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $endRow=1,&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $endOffsetY=0)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;static&nbsp;<a href="../datatype-array.html" class="linkType">array</a> </span></td><td valign="top"><span class="code"><a href="#oneAnchor2twoAnchor(%24sheet,%C2%A0string%20%24coordinates,%C2%A0integer%20%24offsetX,%C2%A0integer%20%24offsetY,%C2%A0integer%20%24width,%C2%A0integer%20%24height)" class="linkSummary">oneAnchor2twoAnchor</a>($sheet,&nbsp;<a href="../datatype-string.html" class="linkType">string</a> $coordinates,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $offsetX,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $offsetY,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $width,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $height)</span></td></tr></table></div><div id="methodDetail"><h2>Method Detail</h2><div class="detail" id="sizeCol($sheet,&nbsp;string $col='A')"><h4>sizeCol</h4><div class="detailContent"><span class="code">public&nbsp;static&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> <b> sizeCol</b>($sheet,&nbsp;<a href="../datatype-string.html" class="linkType">string</a> $col='A')</span><p><p>Get the width of a column in pixels. We use the relationship y = ceil(7x) where x is the width in intrinsic Excel units (measuring width in number of normal characters) This holds for Arial 10</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$sheet</span> - <br><span class="code">$col</span> - <br></div></div></div><div class="detail" id="sizeRow($sheet,&nbsp;int $row=1)"><h4>sizeRow</h4><div class="detailContent"><span class="code">public&nbsp;static&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> <b> sizeRow</b>($sheet,&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $row=1)</span><p><p>Convert the height of a cell from user's units to pixels. By interpolation the relationship is: y = 4/3x. If the height hasn't been set by the user we use the default value. If the row is hidden we use a value of zero.</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$sheet</span> - <br><span class="code">$row</span> - <br></div></div></div><div class="detail" id="getDistanceX($sheet,&nbsp;string $startColumn='A',&nbsp;int $startOffsetX=0,&nbsp;string $endColumn='A',&nbsp;int $endOffsetX=0)"><h4>getDistanceX</h4><div class="detailContent"><span class="code">public&nbsp;static&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> <b> getDistanceX</b>($sheet,&nbsp;<a href="../datatype-string.html" class="linkType">string</a> $startColumn='A',&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $startOffsetX=0,&nbsp;<a href="../datatype-string.html" class="linkType">string</a> $endColumn='A',&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $endOffsetX=0)</span><p><p>Get the horizontal distance in pixels between two anchors The distanceX is found as sum of all the spanning columns widths minus correction for the two offsets</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$sheet</span> - <br><span class="code">$startColumn</span> - <br><span class="code">$startOffsetX</span> - <br><span class="code">$endColumn</span> - <br><span class="code">$endOffsetX</span> - <br></div></div></div><div class="detail" id="getDistanceY($sheet,&nbsp;int $startRow=1,&nbsp;int $startOffsetY=0,&nbsp;int $endRow=1,&nbsp;int $endOffsetY=0)"><h4>getDistanceY</h4><div class="detailContent"><span class="code">public&nbsp;static&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> <b> getDistanceY</b>($sheet,&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $startRow=1,&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $startOffsetY=0,&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $endRow=1,&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $endOffsetY=0)</span><p><p>Get the vertical distance in pixels between two anchors The distanceY is found as sum of all the spanning rows minus two offsets</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$sheet</span> - <br><span class="code">$startRow</span> - <br><span class="code">$startOffsetY</span> - <br><span class="code">$endRow</span> - <br><span class="code">$endOffsetY</span> - <br></div></div></div><div class="detail" id="oneAnchor2twoAnchor($sheet,&nbsp;string $coordinates,&nbsp;integer $offsetX,&nbsp;integer $offsetY,&nbsp;integer $width,&nbsp;integer $height)"><h4>oneAnchor2twoAnchor</h4><div class="detailContent"><span class="code">public&nbsp;static&nbsp;<a href="../datatype-array.html" class="linkType">array</a> <b> oneAnchor2twoAnchor</b>($sheet,&nbsp;<a href="../datatype-string.html" class="linkType">string</a> $coordinates,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $offsetX,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $offsetY,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $width,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $height)</span><p><p>Convert 1-cell anchor coordinates to 2-cell anchor coordinates This function is ported from PEAR Spreadsheet_Writer_Excel with small modifications <br>Calculate the vertices that define the position of the image as required by the OBJ record.<br><br>+------------+------------+ |	 A	  |	  B	 | +-----+------------+------------+ |	 |(x1,y1)	 |			| |  1  |(A1)._______|______	  | |	 |	|			  |	 | |	 |	|			  |	 | +-----+----|	BITMAP	|-----+ |	 |	|			  |	 | |  2  |	|______________.	 | |	 |			|		(B2)| |	 |			|	 (x2,y2)| +---- +------------+------------+ <br>Example of a bitmap that covers some of the area from cell A1 to cell B2.<br><br>Based on the width and height of the bitmap we need to calculate 8 vars:<br>$col_start, $row_start, $col_end, $row_end, $x1, $y1, $x2, $y2.<br>The width and height of the cells are also variable and have to be taken into account.<br>The values of $col_start and $row_start are passed in from the calling function. The values of $col_end and $row_end are calculated by subtracting the width and height of the bitmap from the width and height of the underlying cells.<br>The vertices are expressed as a percentage of the underlying cell width as follows (rhs values are in pixels):<br><br>x1 = X / W *1024 y1 = Y / H *256 x2 = (X-1) / W *1024 y2 = (Y-1) / H *256 <br>Where:  X is distance from the left side of the underlying cell Y is distance from the top of the underlying cell W is the width of the cell H is the height of the cell</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$sheet</span> - <br><span class="code">$coordinates</span> - <br><span class="code">$offsetX</span> - <br><span class="code">$offsetY</span> - <br><span class="code">$width</span> - <br><span class="code">$height</span> - <br></div></div></div></div></div></body></html>
