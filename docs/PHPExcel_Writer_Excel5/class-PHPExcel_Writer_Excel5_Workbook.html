<html xml:lang="en" lang="en"><!--Generated by PHP_UML on Wed, 24 Feb 2016 02:26:46 +0100--><head><title>PHPExcel_Writer_Excel5\PHPExcel_Writer_Excel5_Workbook</title><link rel="stylesheet" type="text/css" media="all" href="../style.css"></head><body><div id="navigation"><div id="banner"><ul class="sections"><li><a href="../overview-summary.html" title="Summary of all packages">Overview</a></li><li><a href="package-summary.html" title="Summary of PHPExcel_Writer_Excel5">Package</a></li><li class="active">Class</li><li><a href="../index-all.html">Index</a></li></ul><ul class="navigFrame"><a href="../index.html?PHPExcel_Writer_Excel5/class-PHPExcel_Writer_Excel5_Workbook.html" class="navigFrameElem" target="_top">FRAMES</a> <a href="class-PHPExcel_Writer_Excel5_Workbook.html" class="navigFrameElem" target="_top">NO FRAMES</a></ul></div><ul class="siblingSections"><li><a href="class-PHPExcel_Writer_Excel5_Parser.html">Prev Class</a></li><li class="last"><a href="class-PHPExcel_Writer_Excel5_Worksheet.html">Next Class</a></li></ul></div><div id="content"><div class="classSummary"><h3 id="entityPackage">PHPExcel_Writer_Excel5</h3><h1 id="entityName">Class&nbsp;PHPExcel_Writer_Excel5_Workbook</h1><dl class="classTree"><dd><a href="../PHPExcel_Writer_Excel5/class-PHPExcel_Writer_Excel5_BIFFwriter.html">PHPExcel_Writer_Excel5\PHPExcel_Writer_Excel5_BIFFwriter</a></dd><dd class="currentElem" style="padding-left:30px"><img src="../inherit.gif" alt="extended by ">PHPExcel_Writer_Excel5\PHPExcel_Writer_Excel5_Workbook</dd></dl><hr>public&nbsp;class&nbsp;<strong>PHPExcel_Writer_Excel5_Workbook</strong><br>
							extends PHPExcel_Writer_Excel5_BIFFwriter<br><p>PHPExcel_Writer_Excel5_Workbook<div></div></p><hr></div><div id="fieldSummary"><h2>Field Summary</h2><table border="1" class="tableSummary"><tr><td align="right" width="1%" valign="top"><span class="code">private&nbsp;<a href="../PHPExcel_Writer_Excel5/class-PHPExcel_Writer_Excel5_Parser.html" class="linkType">PHPExcel_Writer_Excel5_Parser</a> </span></td><td valign="top"><span class="code"><a href="#%24_parser" class="linkSummary">$_parser</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> </span></td><td valign="top"><span class="code"><a href="#%24_biffsize" class="linkSummary">$_biffsize</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">private&nbsp;<a href="../datatype-array.html" class="linkType">array</a> </span></td><td valign="top"><span class="code"><a href="#%24_xfWriters" class="linkSummary">$_xfWriters</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-array.html" class="linkType">array</a> </span></td><td valign="top"><span class="code"><a href="#%24_palette" class="linkSummary">$_palette</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> </span></td><td valign="top"><span class="code"><a href="#%24_codepage" class="linkSummary">$_codepage</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> </span></td><td valign="top"><span class="code"><a href="#%24_country_code" class="linkSummary">$_country_code</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">private</span></td><td valign="top"><span class="code"><a href="#%24_phpExcel" class="linkSummary">$_phpExcel</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">private&nbsp;<a href="../datatype-array.html" class="linkType">array</a> </span></td><td valign="top"><span class="code"><a href="#%24_fontWriters" class="linkSummary">$_fontWriters</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">private&nbsp;<a href="../datatype-array.html" class="linkType">array</a> </span></td><td valign="top"><span class="code"><a href="#%24_addedFonts" class="linkSummary">$_addedFonts</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">private&nbsp;<a href="../datatype-array.html" class="linkType">array</a> </span></td><td valign="top"><span class="code"><a href="#%24_numberFormats" class="linkSummary">$_numberFormats</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">private&nbsp;<a href="../datatype-array.html" class="linkType">array</a> </span></td><td valign="top"><span class="code"><a href="#%24_addedNumberFormats" class="linkSummary">$_addedNumberFormats</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">private&nbsp;<a href="../datatype-array.html" class="linkType">array</a> </span></td><td valign="top"><span class="code"><a href="#%24_worksheetSizes" class="linkSummary">$_worksheetSizes</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">private&nbsp;<a href="../datatype-array.html" class="linkType">array</a> </span></td><td valign="top"><span class="code"><a href="#%24_worksheetOffsets" class="linkSummary">$_worksheetOffsets</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">private&nbsp;<a href="../datatype-int.html" class="linkType">int</a> </span></td><td valign="top"><span class="code"><a href="#%24_str_total" class="linkSummary">$_str_total</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">private&nbsp;<a href="../datatype-int.html" class="linkType">int</a> </span></td><td valign="top"><span class="code"><a href="#%24_str_unique" class="linkSummary">$_str_unique</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">private&nbsp;<a href="../datatype-array.html" class="linkType">array</a> </span></td><td valign="top"><span class="code"><a href="#%24_str_table" class="linkSummary">$_str_table</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">private&nbsp;<a href="../datatype-mixed.html" class="linkType">mixed</a> </span></td><td valign="top"><span class="code"><a href="#%24_colors" class="linkSummary">$_colors</a></span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">private</span></td><td valign="top"><span class="code"><a href="#%24_escher" class="linkSummary">$_escher</a></span></td></tr></table></div><div id="methodSummary"><h2>Method Summary</h2><table border="1" class="tableSummary"><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#__construct(%24phpExcel=null,%C2%A0mixed%20&amp;%24str_total,%C2%A0mixed%20&amp;%24str_unique,%C2%A0mixed%20&amp;%24str_table,%C2%A0mixed%20&amp;%24colors,%C2%A0mixed%20%24parser)" class="linkSummary">__construct</a>($phpExcel=null,&nbsp;<a href="../datatype-mixed.html" class="linkType">mixed</a> &amp;$str_total,&nbsp;<a href="../datatype-mixed.html" class="linkType">mixed</a> &amp;$str_unique,&nbsp;<a href="../datatype-mixed.html" class="linkType">mixed</a> &amp;$str_table,&nbsp;<a href="../datatype-mixed.html" class="linkType">mixed</a> &amp;$colors,&nbsp;<a href="../datatype-mixed.html" class="linkType">mixed</a> $parser)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-int.html" class="linkType">int</a> </span></td><td valign="top"><span class="code"><a href="#addXfWriter(mixed%20%24style,%C2%A0bool%20%24isStyleXf=false)" class="linkSummary">addXfWriter</a>(<a href="../datatype-mixed.html" class="linkType">mixed</a> $style,&nbsp;<a href="../datatype-bool.html" class="linkType">bool</a> $isStyleXf=false)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-int.html" class="linkType">int</a> </span></td><td valign="top"><span class="code"><a href="#_addFont(%24font)" class="linkSummary">_addFont</a>($font)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-int.html" class="linkType">int</a> </span></td><td valign="top"><span class="code"><a href="#_addColor(string%20%24rgb)" class="linkSummary">_addColor</a>(<a href="../datatype-string.html" class="linkType">string</a> $rgb)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_setPaletteXl97()" class="linkSummary">_setPaletteXl97</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-string.html" class="linkType">string</a> </span></td><td valign="top"><span class="code"><a href="#writeWorkbook(array%20%24pWorksheetSizes=null)" class="linkSummary">writeWorkbook</a>(<a href="../datatype-array.html" class="linkType">array</a> $pWorksheetSizes=null)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_calcSheetOffsets()" class="linkSummary">_calcSheetOffsets</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeAllFonts()" class="linkSummary">_writeAllFonts</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeAllNumFormats()" class="linkSummary">_writeAllNumFormats</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeAllXfs()" class="linkSummary">_writeAllXfs</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeAllStyles()" class="linkSummary">_writeAllStyles</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeExterns()" class="linkSummary">_writeExterns</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeNames()" class="linkSummary">_writeNames</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeAllDefinedNamesBiff8()" class="linkSummary">_writeAllDefinedNamesBiff8</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-string.html" class="linkType">string</a> </span></td><td valign="top"><span class="code"><a href="#_writeDefinedNameBiff8(string%20%24name,%C2%A0string%20%24formulaData,%C2%A0int%20%24sheetIndex=0,%C2%A0bool%20%24isBuiltIn=false)" class="linkSummary">_writeDefinedNameBiff8</a>(<a href="../datatype-string.html" class="linkType">string</a> $name,&nbsp;<a href="../datatype-string.html" class="linkType">string</a> $formulaData,&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $sheetIndex=0,&nbsp;<a href="../datatype-bool.html" class="linkType">bool</a> $isBuiltIn=false)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-string.html" class="linkType">string</a> </span></td><td valign="top"><span class="code"><a href="#_writeShortNameBiff8(string%20%24name,%C2%A0int%20%24sheetIndex=0,%C2%A0%24rangeBounds,%C2%A0bool%20%24isHidden=false)" class="linkSummary">_writeShortNameBiff8</a>(<a href="../datatype-string.html" class="linkType">string</a> $name,&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $sheetIndex=0,&nbsp;$rangeBounds,&nbsp;<a href="../datatype-bool.html" class="linkType">bool</a> $isHidden=false)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeCodepage()" class="linkSummary">_writeCodepage</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeWindow1()" class="linkSummary">_writeWindow1</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeBoundsheet(%24sheet,%C2%A0integer%20%24offset)" class="linkSummary">_writeBoundsheet</a>($sheet,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $offset)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeSupbookInternal()" class="linkSummary">_writeSupbookInternal</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeExternsheetBiff8()" class="linkSummary">_writeExternsheetBiff8</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeStyle()" class="linkSummary">_writeStyle</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeNumFormat(string%20%24format,%C2%A0integer%20%24ifmt)" class="linkSummary">_writeNumFormat</a>(<a href="../datatype-string.html" class="linkType">string</a> $format,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $ifmt)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeDatemode()" class="linkSummary">_writeDatemode</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeExterncount(integer%20%24cxals)" class="linkSummary">_writeExterncount</a>(<a href="../datatype-integer.html" class="linkType">integer</a> $cxals)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeExternsheet(string%20%24sheetname)" class="linkSummary">_writeExternsheet</a>(<a href="../datatype-string.html" class="linkType">string</a> $sheetname)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeNameShort(integer%20%24index,%C2%A0integer%20%24type,%C2%A0integer%20%24rowmin,%C2%A0integer%20%24rowmax,%C2%A0integer%20%24colmin,%C2%A0integer%20%24colmax)" class="linkSummary">_writeNameShort</a>(<a href="../datatype-integer.html" class="linkType">integer</a> $index,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $type,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $rowmin,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $rowmax,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $colmin,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $colmax)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeNameLong(integer%20%24index,%C2%A0integer%20%24type,%C2%A0integer%20%24rowmin,%C2%A0integer%20%24rowmax,%C2%A0integer%20%24colmin,%C2%A0integer%20%24colmax)" class="linkSummary">_writeNameLong</a>(<a href="../datatype-integer.html" class="linkType">integer</a> $index,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $type,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $rowmin,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $rowmax,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $colmin,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $colmax)</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-string.html" class="linkType">string</a> </span></td><td valign="top"><span class="code"><a href="#_writeCountry()" class="linkSummary">_writeCountry</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-string.html" class="linkType">string</a> </span></td><td valign="top"><span class="code"><a href="#_writeRecalcId()" class="linkSummary">_writeRecalcId</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writePalette()" class="linkSummary">_writePalette</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-string.html" class="linkType">string</a> </span></td><td valign="top"><span class="code"><a href="#_writeSharedStringsTable()" class="linkSummary">_writeSharedStringsTable</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#_writeMsoDrawingGroup()" class="linkSummary">_writeMsoDrawingGroup</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;</span></td><td valign="top"><span class="code"><a href="#getEscher()" class="linkSummary">getEscher</a>()</span></td></tr><tr><td align="right" width="1%" valign="top"><span class="code">&nbsp;<a href="../datatype-void.html" class="linkType">void</a> </span></td><td valign="top"><span class="code"><a href="#setEscher(%24pValue=null)" class="linkSummary">setEscher</a>($pValue=null)</span></td></tr></table></div><div id="fieldDetail"><h2>Field Detail</h2><div class="detail" id="$_parser"><h4>$_parser</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../PHPExcel_Writer_Excel5/class-PHPExcel_Writer_Excel5_Parser.html" class="linkType">PHPExcel_Writer_Excel5_Parser</a> <b> $_parser</b></span><p>Formula parser<div></div></p></div></div><hr><div class="detail" id="$_biffsize"><h4>$_biffsize</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> <b> $_biffsize</b></span><p>The BIFF file size for the workbook.<div></div></p></div></div><hr><div class="detail" id="$_xfWriters"><h4>$_xfWriters</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-array.html" class="linkType">array</a> <b> $_xfWriters</b> = array()</span><p>XF Writers<div></div></p></div></div><hr><div class="detail" id="$_palette"><h4>$_palette</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-array.html" class="linkType">array</a> <b> $_palette</b></span><p>Array containing the colour palette<div></div></p></div></div><hr><div class="detail" id="$_codepage"><h4>$_codepage</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> <b> $_codepage</b></span><p>The codepage indicates the text encoding used for strings<div></div></p></div></div><hr><div class="detail" id="$_country_code"><h4>$_country_code</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> <b> $_country_code</b></span><p>The country code used for localization<div></div></p></div></div><hr><div class="detail" id="$_phpExcel"><h4>$_phpExcel</h4><div class="detailContent"><span class="code">private<b> $_phpExcel</b></span><p>Workbook<div></div></p></div></div><hr><div class="detail" id="$_fontWriters"><h4>$_fontWriters</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-array.html" class="linkType">array</a> <b> $_fontWriters</b> = array()</span><p>Fonts writers<div></div></p></div></div><hr><div class="detail" id="$_addedFonts"><h4>$_addedFonts</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-array.html" class="linkType">array</a> <b> $_addedFonts</b> = array()</span><p>Added fonts. Maps from font's hash =&gt; index in workbook<div></div></p></div></div><hr><div class="detail" id="$_numberFormats"><h4>$_numberFormats</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-array.html" class="linkType">array</a> <b> $_numberFormats</b> = array()</span><p>Shared number formats<div></div></p></div></div><hr><div class="detail" id="$_addedNumberFormats"><h4>$_addedNumberFormats</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-array.html" class="linkType">array</a> <b> $_addedNumberFormats</b> = array()</span><p>Added number formats. Maps from numberFormat's hash =&gt; index in workbook<div></div></p></div></div><hr><div class="detail" id="$_worksheetSizes"><h4>$_worksheetSizes</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-array.html" class="linkType">array</a> <b> $_worksheetSizes</b> = array()</span><p>Sizes of the binary worksheet streams<div></div></p></div></div><hr><div class="detail" id="$_worksheetOffsets"><h4>$_worksheetOffsets</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-array.html" class="linkType">array</a> <b> $_worksheetOffsets</b> = array()</span><p>Offsets of the binary worksheet streams relative to the start of the global workbook stream<div></div></p></div></div><hr><div class="detail" id="$_str_total"><h4>$_str_total</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-int.html" class="linkType">int</a> <b> $_str_total</b></span><p>Total number of shared strings in workbook<div></div></p></div></div><hr><div class="detail" id="$_str_unique"><h4>$_str_unique</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-int.html" class="linkType">int</a> <b> $_str_unique</b></span><p>Number of unique shared strings in workbook<div></div></p></div></div><hr><div class="detail" id="$_str_table"><h4>$_str_table</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-array.html" class="linkType">array</a> <b> $_str_table</b></span><p>Array of unique shared strings in workbook<div></div></p></div></div><hr><div class="detail" id="$_colors"><h4>$_colors</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-mixed.html" class="linkType">mixed</a> <b> $_colors</b></span><p>Color cache<div></div></p></div></div><hr><div class="detail" id="$_escher"><h4>$_escher</h4><div class="detailContent"><span class="code">private<b> $_escher</b></span><p>Escher object corresponding to MSODRAWINGGROUP<div></div></p></div></div><hr></div><div id="methodDetail"><h2>Method Detail</h2><div class="detail" id="__construct($phpExcel=null,&nbsp;mixed &amp;$str_total,&nbsp;mixed &amp;$str_unique,&nbsp;mixed &amp;$str_table,&nbsp;mixed &amp;$colors,&nbsp;mixed $parser)"><h4>__construct</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> __construct</b>($phpExcel=null,&nbsp;<a href="../datatype-mixed.html" class="linkType">mixed</a> &amp;$str_total,&nbsp;<a href="../datatype-mixed.html" class="linkType">mixed</a> &amp;$str_unique,&nbsp;<a href="../datatype-mixed.html" class="linkType">mixed</a> &amp;$str_table,&nbsp;<a href="../datatype-mixed.html" class="linkType">mixed</a> &amp;$colors,&nbsp;<a href="../datatype-mixed.html" class="linkType">mixed</a> $parser)</span><p><p>Class constructor</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$phpExcel</span> - <br><span class="code">$str_total</span> - <br><span class="code">$str_unique</span> - <br><span class="code">$str_table</span> - <br><span class="code">$colors</span> - <br><span class="code">$parser</span> - <br></div></div></div><div class="detail" id="addXfWriter(mixed $style,&nbsp;bool $isStyleXf=false)"><h4>addXfWriter</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-int.html" class="linkType">int</a> <b> addXfWriter</b>(<a href="../datatype-mixed.html" class="linkType">mixed</a> $style,&nbsp;<a href="../datatype-bool.html" class="linkType">bool</a> $isStyleXf=false)</span><p><p>Add a new XF writer</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$style</span> - <br><span class="code">$isStyleXf</span> - <br></div></div></div><div class="detail" id="_addFont($font)"><h4>_addFont</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-int.html" class="linkType">int</a> <b> _addFont</b>($font)</span><p><p>Add a font to added fonts</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$font</span> - <br></div></div></div><div class="detail" id="_addColor(string $rgb)"><h4>_addColor</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-int.html" class="linkType">int</a> <b> _addColor</b>(<a href="../datatype-string.html" class="linkType">string</a> $rgb)</span><p><p>Alter color palette adding a custom color</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$rgb</span> - <br></div></div></div><div class="detail" id="_setPaletteXl97()"><h4>_setPaletteXl97</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _setPaletteXl97</b>()</span><p><p>Sets the colour palette to the Excel 97+ default.</p></p></div></div><div class="detail" id="writeWorkbook(array $pWorksheetSizes=null)"><h4>writeWorkbook</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-string.html" class="linkType">string</a> <b> writeWorkbook</b>(<a href="../datatype-array.html" class="linkType">array</a> $pWorksheetSizes=null)</span><p><p>Assemble worksheets into a workbook and send the BIFF data to an OLE storage.</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$pWorksheetSizes</span> - <br></div></div></div><div class="detail" id="_calcSheetOffsets()"><h4>_calcSheetOffsets</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _calcSheetOffsets</b>()</span><p><p>Calculate offsets for Worksheet BOF records.</p></p></div></div><div class="detail" id="_writeAllFonts()"><h4>_writeAllFonts</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeAllFonts</b>()</span><p><p>Store the Excel FONT records.</p></p></div></div><div class="detail" id="_writeAllNumFormats()"><h4>_writeAllNumFormats</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeAllNumFormats</b>()</span><p><p>Store user defined numerical formats i.e. FORMAT records</p></p></div></div><div class="detail" id="_writeAllXfs()"><h4>_writeAllXfs</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeAllXfs</b>()</span><p><p>Write all XF records.</p></p></div></div><div class="detail" id="_writeAllStyles()"><h4>_writeAllStyles</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeAllStyles</b>()</span><p><p>Write all STYLE records.</p></p></div></div><div class="detail" id="_writeExterns()"><h4>_writeExterns</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeExterns</b>()</span><p><p>Write the EXTERNCOUNT and EXTERNSHEET records. These are used as indexes for the NAME records.</p></p></div></div><div class="detail" id="_writeNames()"><h4>_writeNames</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeNames</b>()</span><p><p>Write the NAME record to define the print area and the repeat rows and cols.</p></p></div></div><div class="detail" id="_writeAllDefinedNamesBiff8()"><h4>_writeAllDefinedNamesBiff8</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeAllDefinedNamesBiff8</b>()</span><p><p>Writes all the DEFINEDNAME records (BIFF8).<br>So far this is only used for repeating rows/columns (print titles) and print areas</p></p></div></div><div class="detail" id="_writeDefinedNameBiff8(string $name,&nbsp;string $formulaData,&nbsp;int $sheetIndex=0,&nbsp;bool $isBuiltIn=false)"><h4>_writeDefinedNameBiff8</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-string.html" class="linkType">string</a> <b> _writeDefinedNameBiff8</b>(<a href="../datatype-string.html" class="linkType">string</a> $name,&nbsp;<a href="../datatype-string.html" class="linkType">string</a> $formulaData,&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $sheetIndex=0,&nbsp;<a href="../datatype-bool.html" class="linkType">bool</a> $isBuiltIn=false)</span><p><p>Write a DEFINEDNAME record for BIFF8 using explicit binary formula data</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$name</span> - <br><span class="code">$formulaData</span> - <br><span class="code">$sheetIndex</span> - <br><span class="code">$isBuiltIn</span> - <br></div></div></div><div class="detail" id="_writeShortNameBiff8(string $name,&nbsp;int $sheetIndex=0,&nbsp;$rangeBounds,&nbsp;bool $isHidden=false)"><h4>_writeShortNameBiff8</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-string.html" class="linkType">string</a> <b> _writeShortNameBiff8</b>(<a href="../datatype-string.html" class="linkType">string</a> $name,&nbsp;<a href="../datatype-int.html" class="linkType">int</a> $sheetIndex=0,&nbsp;$rangeBounds,&nbsp;<a href="../datatype-bool.html" class="linkType">bool</a> $isHidden=false)</span><p><p>Write a short NAME record</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$name</span> - <br><span class="code">$sheetIndex</span> - <br><span class="code">$rangeBounds</span> - <br><span class="code">$isHidden</span> - <br></div></div></div><div class="detail" id="_writeCodepage()"><h4>_writeCodepage</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeCodepage</b>()</span><p><p>Stores the CODEPAGE biff record.</p></p></div></div><div class="detail" id="_writeWindow1()"><h4>_writeWindow1</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeWindow1</b>()</span><p><p>Write Excel BIFF WINDOW1 record.</p></p></div></div><div class="detail" id="_writeBoundsheet($sheet,&nbsp;integer $offset)"><h4>_writeBoundsheet</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeBoundsheet</b>($sheet,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $offset)</span><p><p>Writes Excel BIFF BOUNDSHEET record.</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$sheet</span> - <br><span class="code">$offset</span> - <br></div></div></div><div class="detail" id="_writeSupbookInternal()"><h4>_writeSupbookInternal</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeSupbookInternal</b>()</span><p><p>Write Internal SUPBOOK record</p></p></div></div><div class="detail" id="_writeExternsheetBiff8()"><h4>_writeExternsheetBiff8</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeExternsheetBiff8</b>()</span><p><p>Writes the Excel BIFF EXTERNSHEET record. These references are used by formulas.</p></p></div></div><div class="detail" id="_writeStyle()"><h4>_writeStyle</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeStyle</b>()</span><p><p>Write Excel BIFF STYLE records.</p></p></div></div><div class="detail" id="_writeNumFormat(string $format,&nbsp;integer $ifmt)"><h4>_writeNumFormat</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeNumFormat</b>(<a href="../datatype-string.html" class="linkType">string</a> $format,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $ifmt)</span><p><p>Writes Excel FORMAT record for non "built-in" numerical formats.</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$format</span> - <br><span class="code">$ifmt</span> - <br></div></div></div><div class="detail" id="_writeDatemode()"><h4>_writeDatemode</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeDatemode</b>()</span><p><p>Write DATEMODE record to indicate the date system in use (1904 or 1900).</p></p></div></div><div class="detail" id="_writeExterncount(integer $cxals)"><h4>_writeExterncount</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeExterncount</b>(<a href="../datatype-integer.html" class="linkType">integer</a> $cxals)</span><p><p>Write BIFF record EXTERNCOUNT to indicate the number of external sheet references in the workbook.<br><br>Excel only stores references to external sheets that are used in NAME.<br>The workbook NAME record is required to define the print area and the repeat rows and columns.<br><br>A similar method is used in Worksheet.php for a slightly different purpose.</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$cxals</span> - <br></div></div></div><div class="detail" id="_writeExternsheet(string $sheetname)"><h4>_writeExternsheet</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeExternsheet</b>(<a href="../datatype-string.html" class="linkType">string</a> $sheetname)</span><p><p>Writes the Excel BIFF EXTERNSHEET record. These references are used by formulas. NAME record is required to define the print area and the repeat rows and columns.<br><br>A similar method is used in Worksheet.php for a slightly different purpose.</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$sheetname</span> - <br></div></div></div><div class="detail" id="_writeNameShort(integer $index,&nbsp;integer $type,&nbsp;integer $rowmin,&nbsp;integer $rowmax,&nbsp;integer $colmin,&nbsp;integer $colmax)"><h4>_writeNameShort</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeNameShort</b>(<a href="../datatype-integer.html" class="linkType">integer</a> $index,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $type,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $rowmin,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $rowmax,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $colmin,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $colmax)</span><p><p>Store the NAME record in the short format that is used for storing the print area, repeat rows only and repeat columns only.</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$index</span> - <br><span class="code">$type</span> - <br><span class="code">$rowmin</span> - <br><span class="code">$rowmax</span> - <br><span class="code">$colmin</span> - <br><span class="code">$colmax</span> - <br></div></div></div><div class="detail" id="_writeNameLong(integer $index,&nbsp;integer $type,&nbsp;integer $rowmin,&nbsp;integer $rowmax,&nbsp;integer $colmin,&nbsp;integer $colmax)"><h4>_writeNameLong</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeNameLong</b>(<a href="../datatype-integer.html" class="linkType">integer</a> $index,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $type,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $rowmin,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $rowmax,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $colmin,&nbsp;<a href="../datatype-integer.html" class="linkType">integer</a> $colmax)</span><p><p>Store the NAME record in the long format that is used for storing the repeat rows and columns when both are specified. This shares a lot of code with _writeNameShort() but we use a separate method to keep the code clean.<br>Code abstraction for reuse can be carried too far, and I should know. ;-)</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$index</span> - <br><span class="code">$type</span> - <br><span class="code">$rowmin</span> - <br><span class="code">$rowmax</span> - <br><span class="code">$colmin</span> - <br><span class="code">$colmax</span> - <br></div></div></div><div class="detail" id="_writeCountry()"><h4>_writeCountry</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-string.html" class="linkType">string</a> <b> _writeCountry</b>()</span><p><p>Stores the COUNTRY record for localization</p></p></div></div><div class="detail" id="_writeRecalcId()"><h4>_writeRecalcId</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-string.html" class="linkType">string</a> <b> _writeRecalcId</b>()</span><p><p>Write the RECALCID record</p></p></div></div><div class="detail" id="_writePalette()"><h4>_writePalette</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writePalette</b>()</span><p><p>Stores the PALETTE biff record.</p></p></div></div><div class="detail" id="_writeSharedStringsTable()"><h4>_writeSharedStringsTable</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-string.html" class="linkType">string</a> <b> _writeSharedStringsTable</b>()</span><p><p>Handling of the SST continue blocks is complicated by the need to include an additional continuation byte depending on whether the string is split between blocks or whether it starts at the beginning of the block. (There are also additional complications that will arise later when/if Rich Strings are supported).<br><br>The Excel documentation says that the SST record should be followed by an EXTSST record. The EXTSST record is a hash table that is used to optimise access to SST. However, despite the documentation it doesn't seem to be required so we will ignore it.</p></p></div></div><div class="detail" id="_writeMsoDrawingGroup()"><h4>_writeMsoDrawingGroup</h4><div class="detailContent"><span class="code">private&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> _writeMsoDrawingGroup</b>()</span><p><p>Writes the MSODRAWINGGROUP record if needed. Possibly split using CONTINUE records.</p></p></div></div><div class="detail" id="getEscher()"><h4>getEscher</h4><div class="detailContent"><span class="code">public&nbsp;<b> getEscher</b>()</span><p><p>Get Escher object</p></p></div></div><div class="detail" id="setEscher($pValue=null)"><h4>setEscher</h4><div class="detailContent"><span class="code">public&nbsp;<a href="../datatype-void.html" class="linkType">void</a> <b> setEscher</b>($pValue=null)</span><p><p>Set Escher object</p></p><h3 class="titleSmallList">Parameters</h3><div class="smallList"><span class="code">$pValue</span> - <br></div></div></div></div></div></body></html>
